<html>
	<head>
        <link href="style.css" rel="stylesheet">
        <title> SECIOTT: Ensuring End-to-End IoT Data Security through Cloud-Enhanced Confidential Computing </title>
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
	</head>

	<body  style="background-color:#FFFFFF"; oncontextmenu="return false";>
		<header id="header">
			<!-- resume header with your name and title -->
			<h1 style="color: darkblue;"><b> SECIOTT: Ensuring End-to-End IoT Data Security through Cloud-Enhanced Confidential Computing </b></h1>
            <!--<p class="p-welcome"> Welcome to my personal website. Feel free to contact me about my works</p> -->
			<hr>

			<p style="text-align:justify"> The IOT devices are rapidly becoming ubiquitous for their ability to effortlessly automate processes by interconnecting smart devices without human intervention. These devices collect data from the most private and sensitive domains of our lives and send to the cloud services for management and further processing including the rule-based automation programs. The cloud services are vulnerable to outside threats, which could cause serious user privacy violations as well as user safety risks leading to unrecoverable loses. Hence, itâ€™s essential to protect the sensitive and private IOT data and rule-based automation programs against different cyberattacks. To safeguard this sensitive and private IOT data, solutions based on trusted execution environments (TEEs) could be utilized, providing end-to-end encrypted solution. However, in this study, we demonstrate that the end-to-end encryption offered by TEE based solutions for IOT devices may not be entirely sufficient. We substantiate this by revealing an attack that can infer sensitive IOT device information, such as the temperature reading of a thermometer, merely by analyzing memory access patterns of the TEE based solution. Our results indicate that in some cases, we can detect the device type with around 95% accuracy and we can infer the values sent by IOT devices (e.g., temperature reading) with approximately 85% accuracy. Subsequently, we design a system called SECIOTT to enhance the overall data security of IOT based solutions in the cloud that prevents these types of attacks by employing strategies such as oblivious execution and data padding. With our defense strategy to mitigate the pattern leakage, we observe significant reduction in device type detection and value prediction with accuracy of at most 27% and 19%, respectively. </p>
			<hr>
		</header>
		<main>
			<article id="mainLeft">
				<section>
					<h2 style="color: darkblue;"><b>CONTACT </b></h2>
					<!-- contact info including social media -->
                    <p>
                        <i class="fa fa-envelope" aria-hidden="true"></i>
                        <a href="mailto:md.shihabul.islam@utdallas.edu">md.shihabul.islam@utdallas.edu</a>
                        <!--<a href="mailto:mahmoud.zamani@utdallas.edu">   Mahmoud.Zamani@UTDallas.edu</a>-->
                    </p>
                    <p>
                        <i class="fa fa-envelope" aria-hidden="true"></i>
                        <a href="mailto:mahmoud.zamani@utdallas.edu">mahmoud.zamani@utdallas.edu</a>
                        <!--<a href="mailto:mahmoud.zamani@utdallas.edu">   Mahmoud.Zamani@UTDallas.edu</a>-->
                    </p>
                    <!--<p>
                        <i class="fab fa-github" aria-hidden="true"></i>
                        <a href="https://github.com/MahmoudZamani"> Mahmoud Zamani</a>
                    </p> -->
				</section>
                <section>
                    <hr><b></b></hr>
					<h2 style="color: darkblue;"><b> SECIOTT Architecture </b></h2>
					<!-- your skills -->
                    <hr><b></b></hr>
                    <center><img src="./images/SECIoTT-Arc.JPG" alt="centered image" ht="1000" width="1000"></center>
                    <!--<hr>-->
			        <p style="text-align:justify"> 
                        <p>We develop a secure end-to-end encrypted IoT rule-based trigger-action platform for smart home automation in the untrusted cloud with state-of-the-art trusted execution environments (TEE), i.e. Intel SGX and ARM TrustZone, and proper cryptographic techniques to alleviate data security and privacy issues in IoT. The principal idea is to utilize TrustZone and SGX to provide security and protection to sensitive IoT data and confidential automation rules at the edge and in the untrusted cloud, respectively.</p>
    
                        <p>Here, we briefly describe the overall architecture, which is demonstrated in Figure X. We consider rule-based trigger-action platform, one of the most widely used IoT programming platforms in the world of IoT automation, where rules contain the automation logic that interconnects multiple devices to enable customized tasks. As a case study, we consider a smart home environment as a motivating application where various interconnected smart IoT devices, such as multipurpose sensors, smart bulbs, smart outlets, security cameras, and so on, are stationed to assist their users with disparate functionalities including home automation.  We assume that the smart IoT devices are equipped with TrustZone and communicate with untrusted cloud services containing SGX to send and receive data. We utilize MQTT (Message Queuing Telemetry Transport) for sending data from the IoT to the cloud and vice versa, which is a standard publish/subscribe messaging protocol specifically designed for the IoT because of its low network bandwidth and minimal code footprint.</p>
                        
                        <p>Note that, our proposed system is agnostic to the underlying IoT platform, and can be employed in any smart platform, such as smart industry, where trigger-action-rule-based automation is deployed in the cloud.</p>
                        
                        <p>The overall flow of the process is outlined below:</p>
                        <ol>
                            <li>Rule Registration: The client registers rules (in trigger-action format) in the cloud server's SGX via secure channel after remote attestation. The rules are encrypted, stored in the cloud filesystem/database, processed against incoming data stream from the IoT devices to carry out the defined automation.</li>
                            <li>IoT Device Setup: The client setups necessary account information (e.g., id), IoT-server communication details (e.g., mqtt), and their basic IoT device information (e.g., id, capability) in the SGX enclave and the respective device's TrustZone.</li>
                            <li>IoT to Server Data Transmission: IoT devices capture data from the environment and send it to the untrusted cloud server after encrypting the payload in the TrustZone.</li>
                            <li>Rule Automation in Server: In the cloud, SGX securely processes the received data after decryption of the payload in the enclave against the registered rules. SGX sends encrypted responses, when required for automation purposes according to the rules, to the particular IoT device.</li>
                            <li>IoT Device Automation: The IoT devices process the response after decryption in the TrustZone.</li>
                        </ol>
			        <hr>
				</section>
				<section>
					<h2 style="color: darkblue;"> <p style="text-align:justify"> <b> Rule Conflict Definitions </b> </p> </h2>
					<!-- your skills -->
                    <hr><b></b></hr>
                    <center> <img src="./images/Table-1-ruleconflictdefinitions.JPG" ht="1000" width="1000"> </center> <hr>
				</section>
                <section>
					<h2 style="color: darkblue;"><b> Sample Rule in JSON  </b></h2>
					<!-- your skills -->
                    <hr><b></b></hr>
                    <center> <img src="./images/Samplerule.JPG" ht="500" width="500"> </center> <hr>
				</section>               
				<section>
					<h2 style="color: darkblue;"><b> Sample Device Event in JSON </b></h2>
                    <hr><b></b></hr> 
                    <center> <img src="./images/SampleDeviceEventinJSON.JPG" ht="500" width="500"> </center> <hr>

  			    </section>
                <section>
                    
					<h2 style="color: darkblue;"><b> Example Run of the Sample Code </b></h2>
					<!-- your skills -->
                    <hr><b></b></hr>
                    <!--<hr>-->
			        <p style="text-align:justify"> 
                    <h2></h2>

                    <h3>Prerequisites:</h3>
                    <p>Intel SGX:</p>
                    <p>Please follow the Readme file to install required sdks, libraries, and packages.</p>
            
                    <p>ARM TrustZone:</p>
                    <p>Please follow the Readme file to install required sdks, libraries, and packages.</p>
            
                <h3>Required Devices:</h3>
                    <ul>
                        <li>System with a processor that supports Intel SGX</li>
                        <li>Raspberry Pi 3</li>
                        <li>Triggering device: Motion Sensor (optional)</li>
                        <li>Triggering device: Temperature Sensor (optional)</li>
                        <li>Actuator device: LED</li>
                    </ul>
            
                <h3>Rule Registration in SGX:</h3>
                <ul>
                    <li>Use the "SampleRules.json" file. It contains a list of rules in trigger-action format in json.</li>
                    <li>Copy this file in the &lt;project-source folder&gt;/datafiles directory</li>
                </ul>
            
                <h3>IoT Device Info Setup:</h3>
                <ul>
                    <li>Use the "SampleDeviceInfo.json" file. It contains:</li>
                    <ul>
                        <li>user information (e.g., user id)</li>
                        <li>necessary device information for each device (e.g., device id, capability, attribute, value unit, topic for pub/sub)</li>
                    </ul>
                    <li>Copy this file in the &lt;project-source folder&gt;/out-br/target/root directory</li>
                </ul>
            
                <h3>Start the Apps (SGX and TrustZone):</h3>
                <ul>
                    <li>Build following the Readme files.</li>
                    <li>First, register the rules in SGX:</li>
                    <ul>
                        <li>Run using command: "./app -r 1 -d 0 -ob 1"</li>
                        <li>Run the python code "RuleManager.py" to encrypt the rules and send to server for processing in SGX
                            enclave.</li>
                        <li>Alternatively, load encrypted ruleset from file "SampleRulesEnc.json" into the MongoDB in collection
                            name "SampleRules".</li>
                    </ul>
                    <li>Second, run the SGX app that waits for incoming trigger-events from registered IoT devices:</li>
                    <ul>
                        <li>Run using command: "./app -r 0 -d 1 -ob 1"</li>
                    </ul>
                    <li>Lastl, run the TrustZone app:</li>
                    <ul>
                        <li>Run the app that sends trigger-events from a motion and temperature sensor to SGX server using
                            command: "optee_example_iot -op 0"</li>
                        <li>Run the app that waits for actuator-commands from SGX server using command: "optee_example_iot -op 1"</li>
                    </ul>
                </ul>
                <hr><b></b></hr>
                <section>
					<h2 style="color: darkblue;"><b>  Sample code-snippet for obliviously checking equality condition </b></h2>
                    <hr><b></b></hr>
                    <center> <img src="./images/SampleCode-SnippetForObliviouslyChecking.JPG" ht="700" width="700"> </center> <hr>

  			    </section>
<!--                <section>
					<h2><b>  Comparison of average execution time for three cases: no SGX, SGX without encryption, and with SGX. A total of 10000 device events are considered with varying Ruleset sizes of 100, 1000, 10000, and 100000. </b></h2>
                    <hr><b></b></hr>
                    <center> <img src="./images/Comparison.JPG" ht="1000" width="1000"> </center>

  			    </section> -->
                <section>
					<h2 style="color: darkblue;"><b> Smart devices used in the Smart Home Automation </b></h2>
                    <hr><b></b></hr>
                    <center> <img src="./images/SmartHomeDevices.JPG" ht="1000" width="1000"> </center> <hr>

  			    </section>
               <!-- <section>
					<h2><b> Comparison of Enclave heap memory (in KB) used for two cases: with SGX and with SGX but without encryption. A total of 10000 device events are considered with varying Ruleset sizes of 100, 1000, 10000, and 100000. </b></h2>
                    <hr><b></b></hr>
                    <center> <img src="./images/Comparison-2.JPG" ht="1000" width="1000"> </center>

  			    </section> -->
              <!--  <section>
					<h2><b> Multiclass classification (10 classes) for predicting (5a) device type and (5b) number of rules satisfied in enclave. </b></h2>
                    <hr><b></b></hr>
                    <center> <img src="./images/MulticlassClassification.JPG" ht="1000" width="1000"> </center>

  			    </section>
                <section>
					<h2><b> Prediction of Motion Sensor Values (active, inactive) </b></h2>
                    <hr><b></b></hr>
                    <center> <img src="./images/MotionSensorPrediction.JPG" ht="1000" width="1000"> </center>

  			    </section>
                <section>
					<h2><b> Prediction of Temperature and Humidity values (5 buckets) </b></h2>
                    <hr><b></b></hr>
                    <center> <img src="./images/TempreturePrediction.JPG" ht="1000" width="1000"> </center>

  			    </section> -->
				<section>
					<h2 style="color: darkblue;"> <b> Conclusion </b> </h2>
					<!-- your education -->
                    <hr style="text-align:justify"> Since the IOT ecosystem is ever-growing, more robust solutions are required to protect private and sensitive user information from falling into the wrong hands. In this paper, we propose an end-to-end secure IOT data management platform, named SECIOTT, by utilizing strong cryptographic techniques and TEEs such as INTEL SGX and ARM TRUST-ZONE. We implement a trigger-action rule-based IOT automation framework as an application of SECIOTT, where we securely operate on the IOT data and rules in the SGX enclave to automate processes for securely controlling and managing IOT devices. We evaluate SECIOTT with IOT data in real-time from real smart devices in a practical smart home scenario. Moreover, we investigate the effect of access pattern leakage attack on SGX and discover that sensitive IoT information can be inferred with notable accuracy, which demonstrates that end-to-end encryption-based TEE solutions are not adequate to safeguard private information. Consequently, we propose countermeasures based on oblivious execution and data padding to obscure the access pattern leakages. Our empirical evaluation suggests that the proposed defense strategy achieves impressive results by significantly reducing the prediction accuracy of IOT data information, and thereby further fortifying the encryption-based TEE solutions and ensuring system security and data privacy. </hr>
                    <h3></h3>
                </section>
                <section>
                    <hr><b></b></hr>
					<h2 style="color: darkblue;"><b> Usages </b></h2>
                    <hr style="text-align:justify"> <b> Readme File Link </b> </hr>
                </section>
                <section>
                    <hr><b></b></hr>
                    <h2 style="color: darkblue;"><b> Download </b></h2>
                    <hr><b></b></hr>
                    <!-- <p> <b> Link:  <a href="https://utdallas.box.com/s/1onexj8emcgorwq5798yu07id1o7m255"> VulGr Dataset </a>.</p> -->
                    <p>I will make the project available and open-source after the paper published. Please let us know if you need our help to reproduce the results and share your feedbacks to improve the current and future works. </b></p>
                </section>
			</article>
			<article id="mainRight">

            <!--    <section>
					<h2><b> Related Pulications </b></h2>
				 about you -->
            <!--        <hr></hr> -->
<!--                    <p>
                        <a href="https://openreview.net/forum?id=rrZtzI7xj2b"> 1.</a></a> <u>Zamani, M.</u>, Irteza, S., et al., Cross Domain Vulnerability Detection Using Graph Contrastive Learning, Accepted in ICLR TinyPaper 2023 </a>
                    </p>
                    <p>
                        <a href="https://www.linkedin.com/in/mahmoud-zamani/"> 2.</a></a> <u>Wickramasuriya, S.</u>, Zamani, M., et al., RANSAQ: Searching Source-Binary Hybrid Code Property Graphs for Vulnerabilities, In final preparation for NDSS 2023  </a>
                    </p>
                    <p>
                        <a href="https://scholar.google.com/citations?view_op=view_citation&hl=en&user=i1OZXOAAAAAJ&citation_for_view=i1OZXOAAAAAJ:UeHWp8X0CEIC"> 3.</a></a> Li, X., Khan, L., <u>Zamani, M.</u>, et al., Con2Mix: A Semi-Supervised Method for Imbalanced Tabular Security Data, 2023 IFIP Annual Conference on Data and Applications Security and Privacy </a>
                    </p>
                    <p>
                        <a href="https://www.linkedin.com/in/mahmoud-zamani/"> 4.</a></a> <u>Zamani, M.</u>, Khan, L., Hamlen, K., Robust Vulnerability Detection Systems Using Explainable AI Methods, INFORM 2023</a>
                    </p>
                    <p>
                        <a href="https://scholar.google.com/citations?view_op=view_citation&hl=en&user=i1OZXOAAAAAJ&citation_for_view=i1OZXOAAAAAJ:UeHWp8X0CEIC"> 5.</a></a> Li, X., Khan, L., <u>Zamani, M.</u>, et a., MCoM: A Semi-Supervised Method for Imbalanced Tabular Security Data. In: Sural, S., Lu, H. (eds) Data and Applications Security and Privacy XXXVI. DBSec 2022.</a>
                    </p>  
				</section> -->
			</article>
		</main>
	</body>
</html>
